{"version":3,"sources":["webpack:///webpack/bootstrap 3c8547301f56319d3bec","webpack:///./src/server/index.js","webpack:///./src/server/app.js","webpack:///external \"path\"","webpack:///external \"lodash\"","webpack:///external \"mpd\"","webpack:///./src/server/server.js","webpack:///external \"socket.io/lib/index.js\"","webpack:///external \"debug\"","webpack:///external \"http\"","webpack:///external \"express\"","webpack:///external \"compression\"","webpack:///external \"cookie-parser\"","webpack:///external \"express-session\"","webpack:///./src/server/meta_data.js","webpack:///external \"bluebird\"","webpack:///external \"fs\"","webpack:///external \"musicmetadata\"","webpack:///./src/server/file_upload.js","webpack:///external \"mkdirp\"","webpack:///external \"util\"","webpack:///external \"underscore\"","webpack:///external \"events\"","webpack:///external \"formidable\"","webpack:///./src/server/clients_manager.js","webpack:///external \"node-uuid\"","webpack:///./src/server/gravatar.js","webpack:///./src/server/helpers/http_follower.js","webpack:///external \"url\"","webpack:///external \"crypto\"","webpack:///external \"querystring\"","webpack:///./config.json","webpack:///./src/server/modes/basic_mode.js","webpack:///./src/server/command_processors.js","webpack:///external \"q\"","webpack:///external \"child_process\"","webpack:///./src/server/command_parsers.js","webpack:///./src/server/response_parsers/object_list_parser.js","webpack:///./src/server/response_parsers/abstract_parser.js","webpack:///./src/server/response_parsers/simple_parser.js","webpack:///./src/server/response_parsers/line_parser.js","webpack:///./src/server/command_emitters.js","webpack:///./src/server/cover_art.js","webpack:///./src/server/modes/master_mode.js"],"names":[],"mappings":"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","file":"server.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\texports: {},\n \t\t\tid: moduleId,\n \t\t\tloaded: false\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.loaded = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"/\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(0);\n\n\n\n/** WEBPACK FOOTER **\n ** webpack/bootstrap 3c8547301f56319d3bec\n **/","\nvar MPDiscoApp = require('./app.js');\n\nvar mpdisco = new MPDiscoApp(MPDiscoApp.Modes.Master);\n\n\n/** WEBPACK FOOTER **\n ** ./src/server/index.js\n **/","import path from 'path';\nimport _ from 'lodash';\nimport mpd from 'mpd';\n\nimport Server from './server.js';\n\nexport default class MPDisco {\n    constructor(mode, options) {\n        this.options = _.defaults({\n            mpdPort: 6600,\n            mpdHost: 'localhost',\n            serverPort: process.env.PORT,\n            config: require('../../config.json')\n        }, options);\n\n        this.mpd = mpd.connect({\n            port: this.options.mpdPort,\n            host: this.options.mpdHost\n        });\n\n        this.mpd.on('ready', function () {\n            console.log('MPDisco Server :: MPD :: connection established');\n        });\n\n        this.mode = mode.create(this.mpd);\n\n        this.server = new Server(this.mpd, this.mode, this.options);\n        this.server.start();\n    }\n}\n\nMPDisco.Modes = {\n    Basic: require('./modes/basic_mode.js'),\n    Master: require('./modes/master_mode.js')\n};\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/server/app.js\n **/","module.exports = require(\"path\");\n\n\n/*****************\n ** WEBPACK FOOTER\n ** external \"path\"\n ** module id = 2\n ** module chunks = 0\n **/","module.exports = require(\"lodash\");\n\n\n/*****************\n ** WEBPACK FOOTER\n ** external \"lodash\"\n ** module id = 3\n ** module chunks = 0\n **/","module.exports = require(\"mpd\");\n\n\n/*****************\n ** WEBPACK FOOTER\n ** external \"mpd\"\n ** module id = 4\n ** module chunks = 0\n **/","var\n    debug = require('debug')('mpdisco:server'),\n    path = require('path'),\n    http = require('http'),\n    express = require('express'),\n    compression = require('compression'),\n    cookieParser = require('cookie-parser'),\n    session = require('express-session'),\n    _ = require('lodash');\n\nimport io from 'socket.io/lib/index.js';\n\nvar __pwd = path.join(__dirname, '..');\n\nvar metadata = require('./meta_data.js');\nvar upload = require('./file_upload.js');\nvar ClientsManager = require('./clients_manager.js');\n\nexport default class Server {\n    static defaults = {\n        serverPort: 3000\n    };\n\n    constructor(mpd, mode, options) {\n        this.options = _.defaults(Server.defaults, options);\n\n        this.mpd = mpd;\n        this.mode = mode;\n\n        this.uploadHandler = this._initUploadHandler(this.mpd, this.options.config);\n\n        var sessionStore = session({\n            name: this.options.config.session_key,\n            secret: this.options.config.secret,\n            resave: false,\n            saveUninitialized: true\n        });\n\n        this.app = express();\n        this._initApp(this.app, this.options, sessionStore);\n\n        this.server = http.Server(this.app);\n\n        this.clientsManager = ClientsManager.instance();\n\n        this.socket = io(this.server);\n        this._initSocketIO(this.socket, sessionStore, this.clientsManager);\n    }\n\n    _initApp(app, options, session) {\n\n        var config = options.config;\n\n        app.use(compression());\n        app.use(cookieParser());\n\n        app.use(session);\n\n        app.use(express.static(path.join(__pwd, '/public')));\n\n        app.get('/', function (req, res) {\n            res.sendFile(path.join(__pwd, 'server', 'views', 'index.html'));\n        });\n\n        app.get('/covers/:artist/:album', function (req, res) {\n            var mm = require('./meta_data.js'),\n                artist = mm.safeName(req.params.artist),\n                album = mm.safeName(req.params.album),\n                file = path.join(config.music_directory.replace(/^~/, process.env.HOME), artist, album, 'front.jpg');\n\n            res.sendFile(file, {maxAge: 7 * 24 * 60 * 60 * 1000});\n        });\n\n        app.all('/upload', this.uploadHandler);\n    }\n\n    start() {\n        var options = this.options;\n        var port = options.serverPort;\n\n        this.server.listen(port, function () {\n          if (process.send) {\n            process.send('online');\n          } else {\n            console.log('MPDisco Server :: Listening on port ' + port);\n          }\n        });\n    }\n\n    _initSocketIO(socket, session, clientsManager) {\n\n        //Socket.io will call this function when a client connects,\n        //So we can send that client a unique ID we use so we can\n        //maintain the list of players.\n        socket.on('connection', function (client) {\n\n            // Embed the session in the client's handshake.\n            session(client.handshake, {}, function() {\n\n                clientsManager.connected(client);\n\n                client.on('command', function (cmd) {\n\n                    this.mode.command(cmd.command, cmd.args, client);\n\n                }.bind(this));\n\n                client.on('commands', function (cmds) {\n\n                    this.mode.commands(cmds, client);\n\n                }.bind(this));\n\n            }.bind(this));\n\n        }.bind(this));\n\n        this.mpd.on('system', function (system) {\n            socket.sockets.emit('update', system);\n            socket.sockets.emit('update:' + system);\n        });\n    }\n\n    _initUploadHandler(mpd, config) {\n        var handler = upload({\n            acceptFileTypes: /\\.(mp3|ogg|flac|mp4)/i,\n            tmpDir: '/tmp',\n            uploadPath: function (file, callback) {\n                metadata.forFile(file)\n                    .then(function(data) {\n                        var parts = _.compact([\n                            config.music_directory.replace(/^~/, process.env.HOME),\n\n                            metadata.safeName(data.artist.length ? data.artist.join('_') : data.artist),\n\n                            metadata.safeName(data.album)\n                        ]);\n\n                        var filename = path.join.apply(this, parts);\n\n                        debug('Saving uploaded file to %s', filename);\n\n                        callback(filename);\n                    })\n                    .fail(function(err) {\n                        console.log(err);\n                    });\n            }\n        });\n\n        handler.on('end', _.debounce(function(result) {\n            debug('Updating database...');\n\n            mpd.sendCommand('update');\n        }.bind(this), 5000));\n\n        return handler;\n    }\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/server/server.js\n **/","module.exports = require(\"socket.io/lib/index.js\");\n\n\n/*****************\n ** WEBPACK FOOTER\n ** external \"socket.io/lib/index.js\"\n ** module id = 6\n ** module chunks = 0\n **/","module.exports = require(\"debug\");\n\n\n/*****************\n ** WEBPACK FOOTER\n ** external \"debug\"\n ** module id = 7\n ** module chunks = 0\n **/","module.exports = require(\"http\");\n\n\n/*****************\n ** WEBPACK FOOTER\n ** external \"http\"\n ** module id = 8\n ** module chunks = 0\n **/","module.exports = require(\"express\");\n\n\n/*****************\n ** WEBPACK FOOTER\n ** external \"express\"\n ** module id = 9\n ** module chunks = 0\n **/","module.exports = require(\"compression\");\n\n\n/*****************\n ** WEBPACK FOOTER\n ** external \"compression\"\n ** module id = 10\n ** module chunks = 0\n **/","module.exports = require(\"cookie-parser\");\n\n\n/*****************\n ** WEBPACK FOOTER\n ** external \"cookie-parser\"\n ** module id = 11\n ** module chunks = 0\n **/","module.exports = require(\"express-session\");\n\n\n/*****************\n ** WEBPACK FOOTER\n ** external \"express-session\"\n ** module id = 12\n ** module chunks = 0\n **/","import Promise from 'bluebird';\nimport fs from 'fs';\nimport mm from 'musicmetadata';\n\nvar MetaData = {\n  forFile: function(path) {\n    return new Promise(function(resolve, reject) {\n      var stream = fs.createReadStream(path);\n\n      var parser = new mm(stream, function(err, metadata) {\n        stream.destroy();\n\n        if (err) {\n          reject(err);\n        } else {\n          resolve(metadata);\n        }\n      });\n    });\n  },\n  safeName: function(s) {\n    if (!s) {\n      return s;\n    }\n\n    return s\n      .trim()\n      .replace('&', ' and ')\n      .replace(/[^\\w\\-,\\.\\s]+/g, '')\n      .replace(/\\b(\\S+?)\\b/g, function(s) {\n        // Uppercase every word.\n        return s.substring(0, 1).toUpperCase() + s.slice(1);\n      }).replace(/\\b(an?|and|of|the|is|for|to|at|but|by|n?or|so)\\b/gi, function(s) {\n        // Lower case connection words.\n        return s.toLowerCase();\n      }).replace(/^(\\S+?)\\b|\\b(\\S+?)$/g, function(s) {\n        // Uppercase first and last words.\n        return s.substring(0, 1).toUpperCase() + s.slice(1);\n      })\n      .replace(/[,\\s\\-]+/g, '_');\n  }\n};\n\nmodule.exports = MetaData;\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/server/meta_data.js\n **/","module.exports = require(\"bluebird\");\n\n\n/*****************\n ** WEBPACK FOOTER\n ** external \"bluebird\"\n ** module id = 14\n ** module chunks = 0\n **/","module.exports = require(\"fs\");\n\n\n/*****************\n ** WEBPACK FOOTER\n ** external \"fs\"\n ** module id = 15\n ** module chunks = 0\n **/","module.exports = require(\"musicmetadata\");\n\n\n/*****************\n ** WEBPACK FOOTER\n ** external \"musicmetadata\"\n ** module id = 16\n ** module chunks = 0\n **/","/*\n * jQuery File Upload Plugin Node.js Example 2.0.3\n * https://github.com/blueimp/jQuery-File-Upload\n *\n * Copyright 2012, Sebastian Tschan\n * https://blueimp.net\n *\n * Licensed under the MIT license:\n * http://www.opensource.org/licenses/MIT\n */\n\n/*jslint nomen: true, regexp: true, unparam: true, stupid: true */\n/*global require, __dirname, unescape, console */\n\nvar path = require('path'),\n    fs = require('fs'),\n    mkdirp = require('mkdirp'),\n    util = require('util'),\n    _ = require('underscore'),\n    EventEmitter = require('events').EventEmitter,\n\n    formidable = require('formidable'),\n    options,\n    defaults = {\n        tmpDir: __dirname + '/../tmp',\n        publicDir: __dirname + '/../public',\n        uploadDir: __dirname + '/../public/files',\n        uploadUrl: '/files/',\n        maxPostSize: 11000000000, // 11 GB\n        minFileSize: 1,\n        maxFileSize: 10000000000, // 10 GB\n        acceptFileTypes: /.+/i,\n        // Files not matched by this regular expression force a download dialog,\n        // to prevent executing any scripts in the context of the service domain:\n        safeFileTypes: /\\.(gif|jpe?g|png)$/i,\n        accessControl: {\n            allowOrigin: '*',\n            allowMethods: 'OPTIONS, HEAD, GET, POST, PUT, DELETE',\n            allowHeaders: 'Content-Type, Content-Range, Content-Disposition'\n        },\n        uploadPath: function(filePath, callback) {\n            callback(options.uploadDir);\n        }\n        /* Uncomment and edit this section to provide the service via HTTPS:\n        ssl: {\n            key: fs.readFileSync('/Applications/XAMPP/etc/ssl.key/server.key'),\n            cert: fs.readFileSync('/Applications/XAMPP/etc/ssl.crt/server.crt')\n        },\n        */\n    },\n    utf8encode = function (str) {\n        return unescape(encodeURIComponent(str));\n    },\n    nameCountRegexp = /(?:(?: \\(([\\d]+)\\))?(\\.[^.]+))?$/,\n    nameCountFunc = function (s, index, ext) {\n        return ' (' + ((parseInt(index, 10) || 0) + 1) + ')' + (ext || '');\n    },\n    FileInfo = function (file) {\n        this.name = file.name;\n        this.size = file.size;\n        this.type = file.type;\n        this.delete_type = 'DELETE';\n    },\n    UploadHandler = function (req, res, callback) {\n        this.req = req;\n        this.res = res;\n        this.callback = callback;\n    };\n\nFileInfo.prototype.validate = function () {\n    if (options.minFileSize && options.minFileSize > this.size) {\n        this.error = 'File is too small';\n    } else if (options.maxFileSize && options.maxFileSize < this.size) {\n        this.error = 'File is too big';\n    } else if (!options.acceptFileTypes.test(this.name)) {\n        this.error = 'Filetype not allowed';\n    }\n    return !this.error;\n};\nFileInfo.prototype.safeName = function () {\n    // Prevent directory traversal and creating hidden system files:\n    this.name = path.basename(this.name).replace(/^\\.+/, '');\n    // Prevent overwriting existing files:\n    while (fs.existsSync(options.uploadDir + '/' + this.name)) {\n        this.name = this.name.replace(nameCountRegexp, nameCountFunc);\n    }\n};\nFileInfo.prototype.initUrls = function (req) {\n    if (!this.error) {\n        var baseUrl = (options.ssl ? 'https:' : 'http:') +\n                '//' + req.headers.host + options.uploadUrl;\n        this.url = this.delete_url = baseUrl + encodeURIComponent(this.name);\n    }\n};\n\nUploadHandler.prototype.get = function () {\n    var handler = this,\n        files = [];\n    fs.readdir(options.uploadDir, function (err, list) {\n        list.forEach(function (name) {\n            var stats = fs.statSync(options.uploadDir + '/' + name),\n                fileInfo;\n            if (stats.isFile() && name[0] !== '.') {\n                fileInfo = new FileInfo({\n                    name: name,\n                    size: stats.size\n                });\n                fileInfo.initUrls(handler.req);\n                files.push(fileInfo);\n            }\n        });\n        handler.callback({files: files});\n    });\n};\n\nUploadHandler.prototype.post = function () {\n    var handler = this,\n        form = new formidable.IncomingForm(),\n        tmpFiles = [],\n        files = [],\n        map = {},\n        counter = 1,\n        redirect,\n        finish = function () {\n            counter -= 1;\n            if (!counter) {\n                files.forEach(function (fileInfo) {\n                    fileInfo.initUrls(handler.req);\n                });\n                handler.callback({files: files}, redirect);\n            }\n        };\n    form.uploadDir = options.tmpDir;\n    form.on('fileBegin', function (name, file) {\n        tmpFiles.push(file.path);\n        var fileInfo = new FileInfo(file, handler.req, true);\n        fileInfo.safeName();\n        map[path.basename(file.path)] = fileInfo;\n        files.push(fileInfo);\n    })\n    .on('field', function (name, value) {\n        if (name === 'redirect') {\n            redirect = value;\n        }\n    })\n    .on('file', function (name, file) {\n        var fileInfo = map[path.basename(file.path)];\n\n        fileInfo.size = file.size;\n        if (!fileInfo.validate()) {\n            fs.unlink(file.path);\n            return;\n        }\n\n        options.uploadPath(file.path, function(uploadPath) {\n\n          mkdirp.sync(uploadPath);\n\n          fs.renameSync(file.path, path.join(uploadPath, fileInfo.name));\n        });\n    })\n    .on('aborted', function () {\n        tmpFiles.forEach(function (file) {\n            fs.unlink(file);\n        });\n    })\n    .on('error', function (e) {\n        console.log(e);\n    })\n    .on('progress', function (bytesReceived, bytesExpected) {\n        if (bytesReceived > options.maxPostSize) {\n            handler.req.connection.destroy();\n        }\n    })\n    .on('end', finish).parse(handler.req);\n};\nUploadHandler.prototype.destroy = function () {\n    var handler = this,\n        fileName;\n    if (handler.req.url.slice(0, options.uploadUrl.length) === options.uploadUrl) {\n        fileName = path.basename(decodeURIComponent(handler.req.url));\n        if (fileName[0] !== '.') {\n            fs.unlink(options.uploadDir + '/' + fileName, function (ex) {\n                handler.callback({success: !ex});\n            });\n            return;\n        }\n    }\n    handler.callback({success: false});\n};\n\nvar FileUpload = function(opts) {\n\n    options = _.defaults(opts, defaults);\n\n    var events = new EventEmitter();\n\n    var fn = function(req, res) {\n        res.setHeader(\n            'Access-Control-Allow-Origin',\n            options.accessControl.allowOrigin\n        );\n        res.setHeader(\n            'Access-Control-Allow-Methods',\n            options.accessControl.allowMethods\n        );\n        res.setHeader(\n            'Access-Control-Allow-Headers',\n            options.accessControl.allowHeaders\n        );\n\n        var handleResult = function (result, redirect) {\n            if (redirect) {\n                res.writeHead(302, {\n                    'Location': redirect.replace(\n                        /%s/,\n                        encodeURIComponent(JSON.stringify(result))\n                    )\n                });\n                res.end();\n            } else {\n                res.writeHead(200, {\n                    'Content-Type': req.headers.accept\n                        .indexOf('application/json') !== -1 ?\n                        'application/json' : 'text/plain'\n                });\n                res.end(JSON.stringify(result));\n            }\n\n            events.emit('end', result);\n        }.bind(this);\n\n        var setNoCacheHeaders = function () {\n            res.setHeader('Pragma', 'no-cache');\n            res.setHeader('Cache-Control', 'no-store, no-cache, must-revalidate');\n            res.setHeader('Content-Disposition', 'inline; filename=\"files.json\"');\n        };\n\n        var handler = new UploadHandler(req, res, handleResult);\n\n        switch (req.method) {\n            case 'OPTIONS':\n                res.end();\n                break;\n            case 'HEAD':\n            case 'GET':\n                if (req.url === '/') {\n                    setNoCacheHeaders();\n                    if (req.method === 'GET') {\n                        handler.get();\n                    } else {\n                        res.end();\n                    }\n                } else {\n                    fileServer.serve(req, res);\n                }\n                break;\n            case 'POST':\n                setNoCacheHeaders();\n                handler.post();\n                break;\n            case 'DELETE':\n                handler.destroy();\n                break;\n            default:\n                res.statusCode = 405;\n                res.end();\n        }\n    };\n\n    _.extend(fn, {\n        on: events.on.bind(events)\n    });\n\n    return fn;\n};\n\nFileUpload.defaults = defaults;\n\nmodule.exports = FileUpload;\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/server/file_upload.js\n **/","module.exports = require(\"mkdirp\");\n\n\n/*****************\n ** WEBPACK FOOTER\n ** external \"mkdirp\"\n ** module id = 18\n ** module chunks = 0\n **/","module.exports = require(\"util\");\n\n\n/*****************\n ** WEBPACK FOOTER\n ** external \"util\"\n ** module id = 19\n ** module chunks = 0\n **/","module.exports = require(\"underscore\");\n\n\n/*****************\n ** WEBPACK FOOTER\n ** external \"underscore\"\n ** module id = 20\n ** module chunks = 0\n **/","module.exports = require(\"events\");\n\n\n/*****************\n ** WEBPACK FOOTER\n ** external \"events\"\n ** module id = 21\n ** module chunks = 0\n **/","module.exports = require(\"formidable\");\n\n\n/*****************\n ** WEBPACK FOOTER\n ** external \"formidable\"\n ** module id = 22\n ** module chunks = 0\n **/","var EventEmitter = require('events').EventEmitter,\n    debug = require('debug')('mpdisco:clients_manager'),\n    uuid = require('node-uuid'),\n    util = require('util'),\n    _ = require('lodash');\n\nvar Gravatar = require('./gravatar.js');\n\nvar EMAIL_REGEX = /^[A-Z0-9._%+-]+@[A-Z0-9.-]+\\.[A-Z]{2,4}$/i;\n\n_.findIndex = function(obj, iterator, context) {\n  var result = -1;\n  _.any(obj, function(value, index, list) {\n      if(iterator.call(context, value, index, list)) {\n          result = index;\n          return true;\n      }\n  });\n  return result;\n};\n\nclass ClientsManager extends EventEmitter {\n  constructor() {\n    super();\n\n    this.loggedClients = [];\n\n    this.clientsHash = {};\n\n    this.disconnectionTimeouts = {};\n  }\n\n  connected(client) {\n    var session = client.handshake.session;\n\n    if (!session.userid) {\n      session.userid = uuid.v4();\n      session.save();\n    }\n\n    var info = client.info = {\n      userid: client.handshake.session.userid\n    };\n\n    var prevClient = this.clientsHash[info.userid];\n\n    //Useful to know when someone connects\n    debug('Client connected: %s', info.userid);\n\n    if (prevClient) {\n      client.info = prevClient.info;\n\n      debug('Client returned: %s', info.userid);\n\n    }\n\n    this.clientsHash[info.userid] = client;\n\n    if (this.disconnectionTimeouts[info.userid]) {\n      clearTimeout(this.disconnectionTimeouts[info.userid]);\n    }\n\n    //When this client disconnects\n    client.on('disconnect', function() {\n      this.disconnected(client);\n    }.bind(this));\n\n    client.on('identify', function(name) {\n      this.performIdentification(client, name);\n    }.bind(this));\n\n    client.on('clientslist', function() {\n      this.sendClientsList(client);\n    }.bind(this));\n\n    if (client.handshake.name) {\n      this.performIdentification(client, client.handshake.name);\n    }\n\n    this.emit('connected', client);\n  }\n\n  disconnected(client) {\n\n    var info = client.info;\n\n    debug('Client disconnected: %s', info.userid);\n\n    debug('Client has 5 seconds to return before dropping...');\n\n    this.disconnectionTimeouts[info.userid] = setTimeout(function() {\n\n      this.dropClient(client);\n\n      client.broadcast.emit('clientdisconnected', info/*, this.clientsInfo*/);\n\n      this.emit('disconnected', client);\n\n    }.bind(this), 5000);\n\n  }\n\n  dropClient(client) {\n    var info = client.info;\n\n    debug('Dropped client: %s', info.userid);\n\n    this.loggedClients = _.reject(this.loggedClients, function(c) { return c.info.userid === info.userid; });\n\n    delete this.clientsHash[info.userid];\n  }\n\n  performIdentification(client, name) {\n     if (!name) {\n       return;\n     }\n\n     if (EMAIL_REGEX.test(name.trim())) {\n       Gravatar.profile(name, false, function(profile) {\n         this.identifyClient(client, profile);\n       }.bind(this));\n     }else{\n       this.identifyClient(client, {\n         displayName: name\n       });\n     }\n  }\n\n  identifyClient(client, profile) { // TODO: Changing logic so that the client queue contains only identified clients might have broken something. Requires testing.\n    var index;\n\n    if (profile.entry && profile.entry.length) {\n      profile = profile.entry[0];\n    }\n\n    client.info = _.extend({ logged: true }, client.info, profile);\n\n    index = _.findIndex(this.loggedClients, function(c) { return c.info.userid === client.info.userid; });\n\n    if (index >= 0) {\n      this.loggedClients[index] = client;\n    } else {\n      this.loggedClients.push(client);\n    }\n\n    debug('Client %s identified as %s.', client.info.userid, client.info.displayName);\n\n    client.emit('identify', client.info);\n    client.broadcast.emit('clientidentified', client.info/*, this.clientsInfo*/);\n\n    this.sendClientsList(client.broadcast);\n    this.sendClientsList(client);\n\n    this.emit('identified', client);\n  }\n\n  sendClientsList(client) {\n    client.emit('clientslist', this.clientsInfo(), client.info);\n  }\n\n  get(userid) {\n    return this.clientsHash[userid];\n  }\n\n  first() {\n    if (this.loggedClients.length) {\n      return this.loggedClients[0];\n    }\n  }\n\n  rotate() {\n    this.loggedClients.push(this.loggedClients.shift());\n  }\n\n  isEmpty() {\n    return this.loggedClients.length <= 0;\n  }\n\n  clientsInfo() {\n    return _.map(this.clientsHash, function(v) {\n      return v.info;\n    }) || [];\n  }\n}\n\nvar ClientsManagerSingleton = function() {\n  if ( ClientsManagerSingleton.prototype._singletonInstance ) {\n    return ClientsManagerSingleton.prototype._singletonInstance;\n  }\n\n  ClientsManagerSingleton.prototype._singletonInstance = new ClientsManager();\n\n  return ClientsManagerSingleton.prototype._singletonInstance;\n};\n\nmodule.exports = {\n  instance: ClientsManagerSingleton\n};\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/server/clients_manager.js\n **/","module.exports = require(\"node-uuid\");\n\n\n/*****************\n ** WEBPACK FOOTER\n ** external \"node-uuid\"\n ** module id = 24\n ** module chunks = 0\n **/","var http = require('./helpers/http_follower.js'),\n    url = require('url'),\n    crypto = require('crypto'),\n    querystring = require('querystring');\n\nfunction createHash(s) {\n  s = s || '';\n\n  return crypto.createHash('md5').update(s.toLowerCase().trim()).digest('hex');\n}\n\nvar Gravatar = {\n  avatar: function (email, options, https) {\n    var baseUrl = (https ? 'https://secure.gravatar.com/' : 'http://www.gravatar.com/'),\n        queryData = querystring.stringify(options),\n        query = (queryData ? \"?\" + queryData : \"\");\n\n    return baseUrl + 'avatar/' + createHash(email) + query;\n  },\n  profileUrl: function(email, format, https) {\n    var baseUrl = (https && \"https://secure.gravatar.com/\") || 'http://www.gravatar.com/';\n\n    format = format || 'json';\n\n    return baseUrl + createHash(email) + '.' + format;\n  },\n  profile: function(email, https, callback, error) {\n    var that = this,\n        options = url.parse(Gravatar.profileUrl(email, 'json', https));\n\n    options.headers = {\n      'User-Agent': 'Mozilla/5.0 (compatible; MPDisco node.js client)'\n    };\n\n    error = error || function() {};\n\n    var req = http.get(options, function(res) {\n      var body = '';\n\n      res.on('data', function(chunk) {\n         body += chunk;\n      });\n\n      res.on('end', function() {\n\n        if (body.indexOf('not found') >= 0) {\n\n          // If no profile was found, send the avatar link anyway.\n\n          callback({\n            displayName: email,\n            thumbnailUrl: that.avatar(email)\n          });\n\n          return;\n        }\n\n        var json = JSON.parse(body);\n\n        callback(json);\n      });\n    })\n    .on('error', error);\n  }\n};\n\nmodule.exports = Gravatar;\n\n\n/** WEBPACK FOOTER **\n ** ./src/server/gravatar.js\n **/","var http = require('http'),\n    url = require('url');\n\nfunction get(options, fn, maxRequests) {\n  var requests = 0;\n\n  maxRequests = maxRequests || 3;\n\n  return http.get(options, function followRedirects(res) {\n\n    if (res.statusCode > 300 && res.statusCode < 400 && res.headers.location) {\n      var location = res.headers.location,\n          opts = url.parse(res.headers.location);\n\n      if (requests > maxRequests) {\n        return;\n      }\n\n      opts.headers = options.headers;\n\n      requests++;\n\n      // The location for some (most) redirects will only contain the path,  not the hostname;\n      // detect this and add the host to the path.\n      if (!opts.hostname) {\n        // Hostname not included; get host from requested URL (url.parse()) and prepend to location.\n        opts.hostname = options.hostname;\n      }\n\n      http.get(opts, followRedirects);\n\n    } else {\n      fn.apply(this, arguments);\n    }\n\n  });\n}\n\nmodule.exports = {\n  get: get\n};\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/server/helpers/http_follower.js\n **/","module.exports = require(\"url\");\n\n\n/*****************\n ** WEBPACK FOOTER\n ** external \"url\"\n ** module id = 27\n ** module chunks = 0\n **/","module.exports = require(\"crypto\");\n\n\n/*****************\n ** WEBPACK FOOTER\n ** external \"crypto\"\n ** module id = 28\n ** module chunks = 0\n **/","module.exports = require(\"querystring\");\n\n\n/*****************\n ** WEBPACK FOOTER\n ** external \"querystring\"\n ** module id = 29\n ** module chunks = 0\n **/","module.exports = {\n\t\"music_directory\": \"~/Music\",\n\t\"secret\": \"secret\",\n\t\"session_key\": \"mpdisco.sid\",\n\t\"master_time\": 60\n};\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./config.json\n ** module id = 30\n ** module chunks = 0\n **/","var debug = require('debug')('mpdisco:mode'),\n    mpd = require('mpd'),\n    mpdcmd = mpd.cmd,\n    _ = require('underscore'),\n    ClientsManager = require('../clients_manager.js'),\n\n    commandProcessors = require('../command_processors.js'),\n    commandParsers = require('../command_parsers.js'),\n    commandEmitters = require('../command_emitters.js');\n\nfunction sanitizeArgs(args) {\n  return args.map(String);\n}\n\nfunction ensureArray(args) {\n  return _.isArray(args) ? args : [args];\n}\n\nfunction execute(mpd, command, args, client) {\n  var cmd;\n\n  args = sanitizeArgs(ensureArray(args));\n\n  cmd = mpdcmd(command, args);\n\n  debug('Received: %s %s', command, JSON.stringify(args));\n\n  mpd.sendCommand(cmd, function(err, result) {\n\n    // First parse the result.\n    var parser = commandParsers.parserForCommand(command, args);\n\n    var response = parser.parse(result);\n\n    // Then emit it to the client.\n    var emitter = commandEmitters.emitterForCommand(command);\n\n    emitter(command, args, response, client);\n  });\n}\n\nvar clientsManager = ClientsManager.instance();\n\nexport default class BasicMode {\n  static create(mpd) {\n    return new BasicMode(mpd);\n  };\n\n  constructor(mpd) {\n    this.type = 'freeforall';\n    this.mpd = mpd;\n  }\n\n  connected(client) {\n    client.emit('connected', {\n      userid: client.info.userid,\n      info: client.info,\n      clients: clientsManager.clientsInfo(),\n      mode: this.type\n    });\n  }\n\n  command(command, args, client) {\n\n    command = command.toLowerCase();\n\n    if (this.canExecute(command, client)) {\n\n      args = sanitizeArgs(ensureArray(args));\n\n      // Run the command through the processor, which calls back with modified args (e.g. Youtube stream from url).\n      var promise = commandProcessors.processorForCommand(this.mpd, command, args);\n\n      promise\n          .then(function(args) {\n            execute(this.mpd, command, args, client);\n          }.bind(this))\n          .fail(function(error) {\n            console.log('Failed to run command: %s (%s) for user %s', command, JSON.stringify(args), client.info.userid);\n            console.log('Error: %s', error);\n\n            client.emit('error', {\n              command: command,\n              args: args\n            });\n          });\n\n    } else {\n      console.log('nopermission', command);\n\n      client.emit(command, {\n        type: 'nopermission'\n      });\n    }\n  }\n  // TODO: Review this.\n  commands(cmds, client) {\n\n    cmds = cmds || [];\n\n    cmds = cmds.map(function(cmd) {\n      cmd.args = sanitizeArgs(ensureArray(cmd.args));\n\n      return cmd;\n    });\n\n    if (_.all(cmds, function(cmd) { return this.canExecute(cmd, client); }, this)) {\n\n      // TODO: Processing each command asynchronously is a bit of a problem. Skipping for now.\n\n      cmds = cmds.map(function(cmd) {\n        return mpdcmd(cmd.command, cmd.args);\n      });\n\n      debug(cmds);\n\n      this.mpd.sendCommands(cmds, function(err, result) {\n\n        debug('Result for command list');\n        debug(cmds);\n        debug('===');\n        debug(result);\n\n      });\n\n    }\n  }\n\n  canExecute(command, client) {\n    return !!clientsManager.get(client.info.userid);\n  }\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/server/modes/basic_mode.js\n **/","var Q = require('q');\nvar debug = require('debug')('mpdisco:command_processors');\nvar exec = require('child_process').exec;\n\nvar processors = {\n  add: function(mpd, args, resolve, reject) {\n    if (!args.length) {\n      reject('No arguments provided.');\n    }\n\n    var url = args[0];\n\n    if (/^https?:\\/\\/.*?youtube.com\\/watch/.test(url)) {\n      // Only run if this matches our condition.\n      exec('youtube-dl -g ' + url, function(error, stdout, stderr) {\n\n        if (error) {\n          reject(error);\n\n          return;\n        }\n\n        var streamUrl = stdout.trim();\n\n        debug('Retrieved stream url for YouTube link %s: %s', url, streamUrl);\n\n        resolve(streamUrl);\n      });\n\n      return;\n    }\n\n    // Just do nothing.\n    resolve(args);\n  }\n};\n\nfunction createProcessorPromise(mpd, command, args) {\n  return Q.promise(function (resolve, reject) {\n    var processor = processors[command];\n\n    if (processor) {\n      processor(mpd, args, resolve, reject);\n    } else {\n      // Do nothing.\n      resolve(args);\n    }\n  });\n}\n\nmodule.exports = {\n  processorForCommand: createProcessorPromise\n};\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/server/command_processors.js\n **/","module.exports = require(\"q\");\n\n\n/*****************\n ** WEBPACK FOOTER\n ** external \"q\"\n ** module id = 33\n ** module chunks = 0\n **/","module.exports = require(\"child_process\");\n\n\n/*****************\n ** WEBPACK FOOTER\n ** external \"child_process\"\n ** module id = 34\n ** module chunks = 0\n **/","var ObjectListParser = require('./response_parsers/object_list_parser.js');\nvar SimpleParser = require('./response_parsers/simple_parser.js');\nvar LineParser = require('./response_parsers/line_parser.js');\n\nvar parsers = {\n    'list':         new LineParser(),\n    'list:album':   new LineParser(),\n    'find':         new ObjectListParser('file'),\n    'playlistinfo': new ObjectListParser('file'),\n    'simple':       new SimpleParser()\n};\n\nmodule.exports = {\n    parsers: parsers,\n    parserForCommand: function(command, args) {\n        var key = command + ':' + args[0];\n\n        return  parsers[key] ||\n            parsers[command] ||\n            parsers.simple;\n    }\n};\n\n\n/** WEBPACK FOOTER **\n ** ./src/server/command_parsers.js\n **/","var AbstractParser = require('./abstract_parser.js'),\n    _ = require('lodash');\n\nexport default class ObjectListParser extends AbstractParser {\n  constructor(separatorKey) {\n    super();\n\n    this.separatorKey = separatorKey;\n  }\n\n  parse(s) {\n    var obj = {},\n        json = [];\n\n    if (!s) {\n      return json;\n    }\n\n    s.split('\\n').forEach(function(l, index) {\n      if (!l) {\n        return;\n      }\n\n      var o = this.parseLine(l);\n\n      // If we ran into an existing key, it means it's a new record.\n      if (o.key === this.separatorKey && index > 0) {\n        json.push(obj);\n\n        obj = {};\n      }\n\n      obj[o.key] = o.value;\n    }, this);\n\n    json.push(obj);\n\n    return json;\n  }\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/server/response_parsers/object_list_parser.js\n **/","export default class AbstractParser {\n  parse(response) {\n    return {};\n  }\n\n  parseLine(l) {\n    var i = l.indexOf(':'),\n        key = l.slice(0, i).toLowerCase().trim(),\n        value = (l.slice(i + 1) || '').trim();\n\n    return {\n      key: key,\n      value: value\n    };\n  }\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/server/response_parsers/abstract_parser.js\n **/","var AbstractParser = require('./abstract_parser.js'),\n  _ = require('lodash');\n\nexport default class SimpleParser extends AbstractParser {\n  parse(s) {\n    if (!s) {\n      return s;\n    }\n\n    var that = this,\n      lines = s.split('\\n'),\n      obj = {},\n      json = [],\n      overwrites = 0;\n\n    _(lines).chain().compact().each(function (l, index) {\n      var o = that.parseLine(l);\n\n      if (obj.hasOwnProperty(o.key) && overwrites >= 2) {\n        console.warn('Key overwrite when parsing response (key=' + o.key + '), SimpleParser could be wrong for response. Response:');\n        console.warn(s);\n      }\n\n      obj[o.key] = o.value;\n    });\n\n    json.push(obj);\n\n    return (json.length == 1 ? json[0] : json);\n  }\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/server/response_parsers/simple_parser.js\n **/","var AbstractParser = require('./abstract_parser.js'),\n    _ = require('lodash');\n\nexport default class LineParser extends AbstractParser {\n  parse(s) {\n    if (!s) {\n      return s;\n    }\n\n    var that = this,\n        lines = s.split('\\n'),\n        obj,\n        json = [];\n\n    _(lines).chain().compact().each(function(l, index) {\n      var o = that.parseLine(l);\n\n      obj = {};\n\n      obj[o.key] = o.value;\n\n      json.push(obj);\n    });\n\n    return json;\n  }\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/server/response_parsers/line_parser.js\n **/","var debug = require('debug')('mpdisco:command_emitters');\nvar CoverArt = require('./cover_art.js');\n\nfunction log(command, args, response) {\n    debug('Emitting: %s %s: %s', command, JSON.stringify(args), JSON.stringify(response));\n}\n\nvar specialEmitters = {\n    list: function emitSpecializedEvent(command, args, response, client) {\n        if (args.length) {\n            log(command, args, response)\n\n            client.emit(command, response);\n\n            command = command + ':' + args[0].toLowerCase();\n\n            log(command, args.slice(1), response)\n\n            client.emit(command, {\n                args: args.slice(1),\n                data: response\n            });\n        }\n    },\n    find: function emitCommandWithEverySecondArg(command, args, response, client) {\n        if (args.length) {\n            log(command, args, response)\n\n            client.emit(command, {\n                args: args.filter(function(v, i) { return (i % 2 == 1); }),\n                data: response\n            });\n        }\n    },\n    currentsong: function(command, args, response, client) {\n\n        client.emit(command, response);\n\n        log(command, args, response)\n\n        if (response && response.artist && response.album) {\n\n            CoverArt\n                .getCover({ artist: response.artist, release: response.album })\n                .then(function(url) {\n                    debug('Sending cover: %s', url);\n\n                    client.emit('coverart', {\n                        url: url\n                    });\n                })\n                .fail(function(error) {\n                    debug('Cover retrieval failed. %s', error);\n\n                    client.emit('coverart', {\n                        url: null\n                    });\n                });\n        }\n    }\n};\n\nfunction simpleEmitter(command, args, response, client) {\n    log(command, args, response);\n\n    client.emit(command, response);\n}\n\nmodule.exports = {\n    emitters: specialEmitters,\n    emitterForCommand: function(command) {\n        return specialEmitters[command] || simpleEmitter;\n    }\n};\n\n\n/** WEBPACK FOOTER **\n ** ./src/server/command_emitters.js\n **/","var config = require('../../config.json'),\n    mm = require('./meta_data.js'),\n    http = require('http'),\n    httpFollower = require('./helpers/http_follower.js'),\n    path = require('path'),\n    fs = require('fs'),\n    Q = require('q'),\n    _ = require('underscore');\n\nclass CoverArt {\n  getCover(options) {\n    var output = this._outputPath(options);\n\n    var promise = Q.promise(function(resolve, reject) {\n\n      var urlName = function(s) {\n        return mm.safeName(s).replace(/_/g, '-').toLowerCase();\n      };\n\n      var path = '/covers/' + urlName(options.artist) + '/' + urlName(options.release);\n\n      if (fs.existsSync(output)) {\n        resolve(path);\n      } else {\n        this._findRelease(options)\n            .then(function(urls) {\n                return this._retrieveCover(urls);\n              }.bind(this), reject)\n            .then(function(url) {\n                return this._downloadCover(url, output);\n              }.bind(this), reject)\n            .done(function() {\n                resolve(path);\n              }, reject);\n      }\n    }.bind(this));\n\n    return promise;\n  }\n\n  _findRelease(options) {\n    return Q.promise(function(resolve, reject) {\n\n      var host = 'musicbrainz.org',\n          path = '/ws/2/release/?fmt=json&query=',\n          query;\n\n      query = _.map(options, function(v, k) { return k + ':\"' + v + '\"'; })\n          .join(' AND ');\n\n      if (!query) {\n        reject('Could not form query.');\n\n        return;\n      }\n\n      var opts = {\n        host: host,\n        path: path + encodeURIComponent(query),\n        headers: {\n          'User-Agent': 'MPDisco/1.0'\n        }\n      };\n\n      http.get(opts, function(res) {\n        var body = '';\n\n        if (res.statusCode != 200) {\n          reject('Server responded with status: ' + res.statusCode);\n\n          return;\n        }\n\n        res.on('data', function(chunk) {\n          body += chunk;\n        });\n\n        res.on('end', function() {\n\n          var json = JSON.parse(body);\n\n          var results = this._extractBestGuessReleases(json);\n\n          if (!results) {\n            reject('No releases found.');\n          }\n\n          var urls = _.map(results, function(result) { return 'http://coverartarchive.org/release/' + result.id + '/front-250'; });\n\n          resolve(urls);\n\n        }.bind(this));\n\n        res.on('error', function(e) {\n          reject(e);\n        });\n      }.bind(this));\n\n    }.bind(this));\n  }\n\n  _retrieveCover(urls) {\n    return Q.promise(function(resolve, reject) {\n      function getCover(url) {\n        if (urls.length <= 0) {\n          reject('No covers found.');\n\n          return;\n        }\n\n        http.get(url, function(res) {\n          if (res.statusCode === 307 && res.headers.location) {\n            resolve(res.headers.location);\n\n            return;\n          }\n\n          getCover(urls.shift());\n        }.bind(this));\n      }\n\n      getCover(urls.shift());\n    });\n  }\n\n  _downloadCover(url, output) {\n    var file = fs.createWriteStream(output);\n\n    var promise = Q.promise(function(resolve, reject) {\n      httpFollower.get(url, function followRedirects(res) {\n        res.pipe(file);\n\n        res.on('end', function() {\n          resolve(file);\n        });\n\n        file.on('error', reject);\n\n        res.on('error', reject);\n      });\n    });\n\n    return promise;\n  }\n\n  _outputPath(options) {\n\n    var output = path.join(config.music_directory.replace(/^~/, process.env.HOME),\n        mm.safeName(options.artist),\n        mm.safeName(options.release),\n        'front.jpg');\n\n    return output;\n  }\n\n  _extractBestGuessReleases(json) {\n\n    var results = [];\n\n    if (json.count <= 0) {\n      return;\n    }\n\n    results.concat( _.where(json.releases, { country: 'US' }));\n\n    results.concat(_.where(json.releases, { country: 'XE' }));\n\n    results.concat(_.where(json.releases, { country: 'GB' }));\n\n    return results.concat(_.without(json.releases, results)); // Append the rest and return.\n\n  }\n}\n\nexport default new CoverArt();\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/server/cover_art.js\n **/","import dbg from 'debug';\nimport BasicMode from './basic_mode.js';\nimport ClientsManager from '../clients_manager.js';\nimport config from '../../../config.json';\n\nconst debug = dbg('mpdisco:master_mode');\n\nexport default class MasterMode extends BasicMode {\n  static commandWhitelist = ['currentsong', 'status', 'playlistinfo', 'list', 'find', 'update'];\n\n  static create(mpd) {\n    return new MasterMode(mpd);\n  };\n\n  constructor(mpd) {\n    super(mpd);\n\n    this.type = 'master';\n\n    this.master = null;\n\n    var clientsManager = this.clientsManager = ClientsManager.instance();\n\n    clientsManager.on('disconnected', this.disconnected.bind(this));\n\n    clientsManager.on('connected', this.connected.bind(this));\n\n    clientsManager.on('identified', this.identified.bind(this));\n  }\n\n  connected(client) {\n    client.emit('connected', {\n      userid: client.info.userid,\n      info: client.info,\n      clients: this.clientsManager.clientsInfo(),\n      mode: this.type,\n      master: this.master\n    });\n  }\n\n  disconnected(client) {\n    if (this.clientsManager.isEmpty()) {\n      this.clearMaster();\n    } else if (!this.isMaster(this.clientsManager.first())) {\n      this.setMaster(this.clientsManager.first());\n    }\n  }\n\n  identified(client) {\n    if (!this.master && !this.clientsManager.isEmpty()) {\n      this.setMaster(this.clientsManager.first());\n    }\n  }\n\n  rotate() {\n    if (this.clientsManager.isEmpty()) {\n      return;\n    }\n\n    this.clientsManager.rotate();\n\n    this.setMaster(this.clientsManager.first());\n  }\n\n  canExecute(command, client) {\n    return this.isMaster(client) || this.isWhitelistCommand(command);\n  }\n\n  isMaster(client) {\n    return this.master === client.info.userid;\n  }\n\n  setMaster(client) {\n    if (!client) {\n      this.master = null;\n\n      debug('Master cleared.');\n\n      return;\n    }\n\n    this.master = client.info.userid;\n\n    debug('Master changed: %s', this.master);\n\n    this.setMasterTimeout();\n\n    client.emit('master', this.master);\n    client.broadcast.emit('master', this.master);\n  }\n\n  clearMaster() {\n    this.setMaster(null);\n  }\n\n  setMasterTimeout() {\n\n    var masterTime = +config.master_time;\n\n    clearTimeout(this.masterTimeout);\n\n    debug('Master timeout: %s min', masterTime);\n\n    this.masterTimestamp = Date.now();\n\n    this.masterTimeout = setTimeout(function() {\n      debug('Rotating master');\n\n      this.clientsManager.rotate();\n\n      this.setMaster(this.clientsManager.first());\n\n    }.bind(this), masterTime * 60 * 1000);\n  }\n\n  isWhitelistCommand(cmd) {\n    return (MasterMode.commandWhitelist.indexOf(cmd) !== -1);\n  }\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/server/modes/master_mode.js\n **/"],"sourceRoot":""}